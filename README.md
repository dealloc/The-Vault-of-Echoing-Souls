# Adventure template

Writing adventures in Foundry for Pathfinder Second Edition is fun, but it's poorly (if at all) documented.
This module helps you get started by providing the most common building blocks for writing adventures.

> [!IMPORTANT]
> See https://paizo.com/pathfinder to learn more about Pathfinder. Paizo Inc. does not guarantee compatibility, and does not endorse this product.

# What's inside
- [automated publishing](#automated-publishing)
- [convenient styling](#convenient-styling)
- [editor macros](#editor-macros)
- [encounter blocks](#encounter-blocks)
- [narrate blocks](#narrate-blocks)
- [rolls styling](#rolls-styling)
- [sidebar/sidenote](#sidebar)
- [tables](#tables)
- [traits](#traits)
- [enhanced journal links](#enhanced-journal-links)
- [out of the box support for popular modules](#automatically-enhance-3rd-party-modules)
- [why put macros in scripts?](#why-put-macros-in-scripts)
- [customizable journals](#customizing-journals)

## Getting started
The template has following folder structure:
- `.github` contains the workflow ([automated publishing](#automated-publishing))
- `packs` contains the compendia generated by Foundry
- `assets` (not generated by default) put your assets (images, videos, audio, ...) here and they'll automatically be included
- `src`
  - `scripts` contains the Javascript handling interactivity etc
    - `hooks` contains the implementation of hooks this module listens to (like Sequencer, ProseMirror, ...)
    - `journals` this is where the journal enhancement code lives
    - `macros` put the macros your module uses here (see [why put macros in scripts](#why-put-macros-in-scripts))
    - `utilities` as it says on the tin, contains utility methods to make your life easier
    - `constants.ts` contains module wide constants to allow reusing identifiers etc
    - `index.ts` this is the file that Foundry starts executing when your module is loaded
    - `macros.ts` this is where you'll want to add your custom macros to make them available to the world
  - `styles` contains the styling and theming for this module
    - `components` this folder contains the 'components' or 'blocks' that style a specific journal thing
    - `style.scss` the source file that gets compiled, everything needs to be linked here to be included
    - `theme.scss` contains the theme variables and functions used for styling journals
    - `utilities.scss` small utility classes that don't relate to a specific journal block

After copying this template, you'll want to update the default slug (`adventure-template`), name (`Adventure Template`) and some others in a few places.
- `/module.json`
    - update `id` and `name` at the top of the file
    - update the `authors` information with your own
- `/src/constants.ts`
    - update the `id` and `name` with the same as the `module.json` file
- `/src/styles/theme.scss`
    - update the `journal-page` mixin to use the `id` (see below)

```scss
// theme.scss

@mixin journal-page {
    //                   ‚¨áÔ∏è replace adventure-template with your ID (KEEP THE DOT)
    .sheet.journal-entry.adventure-template {
        @content;
    }
}
```

## Automated publishing
The template contains a [workflow](.github/workflows/release.yml) that automatically releases your module when you publish a release on Github.

## Convenient styling
All stylings in this template are easy to customize.
They've been organized into 'components' (see [src/styles/components](src/styles/components)) and use variables to allow reusing / customizing easily.
The variables that control most of the styling can be found [here](src/styles/theme.scss), and if you need more advanced customization, take a look at the components themselves.

### Editor macros
To speed up writing journals etc, this module provides a couple 'macros' (not to be confused with Foundry's macros) in the text editor.

The source code for all available snippets can be found [here](src/scripts/hooks/prose-mirror.ts).
Of course you can always add your own snippets by putting them in that file.

### Stat blocks
the Pathfinder Second Edition system for Foundry actually provides built in styling for stat blocks.

```html
<section class="statblock">
    <h1>Name <span>Type 0</span></h1>
    <section class="traits">
        <p class="alignment">N</p>
        <p>trait</p>
    </section>
    <p><em>short italic description</em></p>
    <p><strong>property</strong> description</p>
    <p><strong>property</strong> description</p>
    <hr>
    <p><strong>property</strong> description</p>
    <p><strong>property</strong> description</p>
</section>
```
While developing your module, there's a macro that inserts the code above, you can find it under `Stat block` in the editor (see [editor macros](#editor-macros))

### Encounter blocks
When describing encounters, treasure etc you can use an `.encounter` block:
```html
<section class="encounter">
    <div class="header">
        <img src="icons/fvtt.png">
        <h2>TITLE<span>TYPE</span></h2>
        <p><span class="link">@UUID[Compendium.pf2e.journals.JournalEntry.6L2eweJuM8W7OCf2.JournalEntryPage.JYJd1xZwqUNRNsqG]{Remaster Changes}</span></p>
    </div>
    <p><strong>bottom text</strong></p>
</section>
```
While developing your module, there's a macro that inserts the code above, you can find it under `Encounter block` in the editor (see [editor macros](#editor-macros))

### Narrate blocks
When writing text that the GM should narrate to the players, you can use a `.narrate` block.
These automatically show a `üí¨` bubble on the block, and when clicked post the text in chat.
```html
<section class="narrate">
    <p>Narrate me</p>
</section>
```

### Rolls styling
Pathfinder Second Edition's system module for Foundry has a built in way to call for rolls, saves etc.

While [Github](https://github.com/foundryvtt/pf2e/wiki/Style-Guide) has the full list and details, here's some quick examples to save you a click:

[inline roll links](https://github.com/foundryvtt/pf2e/wiki/Style-Guide#inline-roll-links): 
`[[/roll d20]]` or `[[/roll 2d10+5]]`

[checks](https://github.com/foundryvtt/pf2e/wiki/Style-Guide#inline-check-links):
`@Check[society|dc:20]` or `@Check[fortitude|dc:20|basic]`

[damage rolls](https://github.com/foundryvtt/pf2e/wiki/Style-Guide#inline-roll-links):
`@Damage[2d6]` or `@Damage[2d6[fire]]`

[actions](https://github.com/foundryvtt/pf2e/wiki/Style-Guide#inline-actions):
`[[/act grapple]]` or `[[/act recall-knowledge variant=society dc=20]]`

### Sidebar
oftentimes you'll want to provide some information 'on the side', use a `aside.right` block for this:
```html
<aside class="right">
    <p>side content</p>
</aside>
```

### Tables
The editor provides a built-in way to generate tables.
For some reason, when generating a table it doesn't include a `<thead>` so you'll have to add those yourself.

Aside from the `thead` you don't need to make any further changes.

```html
<table>
    <thead>
        <tr>
            <td>heading left</td>
            <td>heading right</td>
        </tr>
    </thead>
    <tbody>
        
        <tr>
            <td>left</td>
            <td>right</td>
        </tr>
    </tbody>
</table>
```

### Traits
As with tables, the editor has a built in way to style traits. You can further customize them by adding a class to the `p` tag in the `.traits` block:
- `.uncommon`
- `.rare`
- `.unique`
- `.alignment`
- `.size`

### Enhanced journal links
You probably don't know you're missing this, but if you link ambient sounds or scenes in a journal it'll open
the config window instead of toggling the sound or navigating to the scene respectively.
The `AdventureJournalTextPageSheet` automatically intercepts links to those objects and enhance them to make them intuitive.
Clicking an audio link will toggle it (with play/stop button toggle!) and clicking a scene link will navigate (but not activate) to it.

### Automatically enhance 3rd party modules
We optionally support the following 3rd party modules:
- Polyglot
    - If you add journal text with Polyglot languages it'll automatically match the styling of the rest of the journal
- Sequencer
    - Comes out of the box with hook to register assets in the Sequencer database (see [documentation](https://fantasycomputer.works/FoundryVTT-Sequencer/#/database))

### Customizing journals
It's very easy to further customize the general look and feel of the journal pages.
The theme file already contains a variable `$journal-sidebar-background` to customize the background colour of the sidebar.

For more advanced customization, like the borders, background of pages, scrollbars, colours etc look in [_window.scss](src/styles/components/_window.scss).

### Why put macros in scripts?
Whenever an adventure is imported it will copy all macros into the world.
This means if you fix bugs or update macros the adventure would need to be re-imported by the users after updating your module.

By putting them in code, and then executing that code from the macro (as opposed to putting the code directly in a macro in Foundry)
you can update and fix things in macros by simply updating the module, and all macros will automatically reference the updated code.

for example, to use the `setWeather` macro ([set-weather.ts](src/scripts/macros/set-weather.ts)) you'd make a macro in Foundry like this (and change `adventure-template` to what you put in the constants as described in [getting started](#getting-started)):
```javascript
const module = game.modules.get('adventure-template');

module.macros.setWeather();
```

# Helpful links
Below is a non-exhaustive list of links that you should read when developing modules/adventures
- [Foundry VTT API](https://foundryvtt.com/api/index.html)
- [Foundry VTT Community Wiki](https://foundryvtt.wiki/en/development/api)
- [Foundry's Content Creation Guide](https://foundryvtt.com/article/content-creation-guide/)
- [Foundry's Media Optimization Guide](https://foundryvtt.com/article/media/)
- [Foundry's Introduction to Module Development](https://foundryvtt.com/article/module-development/)
- [PF2e's Style Guide wiki](https://github.com/foundryvtt/pf2e/wiki/Style-Guide)
- [PF2e's Creating a PF2e Content Module](https://github.com/foundryvtt/pf2e/wiki/Creating-a-PF2e-Content-Module)
- https://paizo.com/licenses